# Nkar image comparison and differences highlighting API (C++)
Nkar is an image processing and comparison utility. It uses pixel-to-pixel comparison of two images of the same size to identify their differences and generate an outline that highlights the different areas.

### Installation

No installation required. Just compile *color.h(.cpp), image.h(.cpp), point.h(.cpp) and comparator.h(.cpp)* in your project and use `nkar::Comparator` class to compare two images.

### Prerequisites

No special requirements and dependencies except *C++11* compliant compiler. The class is tested with *gcc 4.8.4* and *MSVC 12.0* (Visual Studio 2013).
For more details see the CI badges (*Travis CI & AppVeyor CI*).

### Usage Example:

```cpp
// A simple application that compare two image files and saves differences in a third one.

#include <string>

#include "comparator.h"
#include "image.h"

int main(int argc, char **argv)
{
  if (argc != 4) {
    return -1;
  }

  // Compare two image files.
  auto result = nkar::Comparator::compare(argv[1], argv[2]);

  if (result.error() != nkar::Result::Error::NoError) {
    // An error occurred during comparison.
    fprintf(stderr, "%s\n", result.errorMessage().c_str());
    return -1;
  }

  if (result.status() == nkar::Result::Status::Different) {
    if (result.resultImage().save(argv[3])) {
      fprintf(stdout, "Images are different. The resulting image with highlighting is saved.\n");
      return -1;
    } else {
      fprintf(stderr, "Failed to save result image\n");
      return -1;
    }
  }

  fprintf(stdout, "Images are identical\n");
  return 0;
}
```

### Test

There are unit tests provided for `nkar::Comparator` class. You can find them in the *test/* directory.
To run them you have to build and run the test application. For doing that you must invoke the following
commands from the terminal, assuming that compiler and environment are already configured:

##### Linux (gcc)
```
cd test
g++ -std=c++11 -I../src main.cpp -o test
./test
```

##### Windows
```
cd test
cl /W4 /I../srs /EHsc main.cpp /link /out:test.exe
test
```

### Examples

Below are some examples of image comparison with results. Third image in each row represents an image generated by Comparator and contains highlighting (red outline) of differences.

* Regular geometries (image 1 (empty image), image 2, result):


![alt text](./test/images/empty.png "Image 1") ![alt text](./test/images/13.png "Image 2") ![alt text](./test/images/13_result.png "Result")

* Comparison of Lenna (image 1, image 2, result):

![alt text](./test/images/lenna.png "Image 1") ![alt text](./test/images/lenna_changed.png "Image 2") ![alt text](./test/images/lenna_result.png "Result")

### See Also

For reading and writing image files we used [stb single-file public domain libraries](https://github.com/nothings/stb)